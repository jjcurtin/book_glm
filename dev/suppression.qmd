---
output: html_document
editor_options: 
  chunk_output_type: console
---

# Suppression

```{r}
#| code-fold: false

options(conflicts.policy = "depends.ok") 
library(tidyverse)
library(broom) 

path_data <- "data_lecture"
theme_set(theme_classic()) 
options(scipen = 999) # turns off scientific notation

sse <- function(model){
  sum(residuals(model)^2)
}
```

-------------------------------------------------------------------------------

Generate positively correlated predictors with positive effect on y 
```{r}
library(MASS, exclude = c("select"))
set.seed(123)
mu <- c(0, 0, 0)
sigma <- matrix(c(1, 0.4, 0.6,
                  0.4, 1, 0.3,
                  0.6, 0.3, 1), nrow = 3)

d_pos <- (mvrnorm(n = 100, mu = mu, Sigma = sigma))
colnames(d_pos) <- c("x1", "x2", "y")
d_pos <- as_tibble(d_pos)

cor(d_pos)
```

-------------------------------------------------------------------------------

Overall effects of x1 and x2 on y
```{r}
lm(y ~ x1, data = d_pos) |> 
  tidy()

lm(y ~ x2, data = d_pos) |> 
  tidy()
```

Partial (direct, unique) effects of x1 and x2 on y
```{r}
lm(y ~ x1 + x2, data = d_pos) |> 
  tidy()
```

-------------------------------------------------------------------------------

## Path diagram

-------------------------------------------------------------------------------

Generate positively correlated predictors with negative effect on y 
```{r}
mu <- c(0, 0, 0)
sigma <- matrix(c(1, 0.4, -0.6,
                  0.4, 1, -0.3,
                  -0.6, -0.3, 1), nrow = 3)

d_neg <- (mvrnorm(n = 100, mu = mu, Sigma = sigma))
colnames(d_neg) <- c("x1", "x2", "y")
d_neg <- as_tibble(d_neg)

cor(d_neg)
```

-------------------------------------------------------------------------------

Overall effects of x1 and x2 on y
```{r}
lm(y ~ x1, data = d_neg) |> 
  tidy()

lm(y ~ x2, data = d_neg) |> 
  tidy()
```

Partial (direct, unique) effects of x1 and x2 on y
```{r}
lm(y ~ x1 + x2, data = d_neg) |> 
  tidy()
```

-------------------------------------------------------------------------------

## Path diagram



-------------------------------------------------------------------------------

Negatively correlated predictors with positive effects on y


```{r}
mu <- c(0, 0, 0)
sigma <- matrix(c(1, -0.4, 0.6,
                  -0.4, 1, 0.3,
                  0.6, 0.3, 1), nrow = 3)

d_mixed <- (mvrnorm(n = 100, mu = mu, Sigma = sigma))
colnames(d_mixed) <- c("x1", "x2", "y")
d_mixed <- as_tibble(d_mixed)

cor(d_mixed)
```


-------------------------------------------------------------------------------

Overall effects of x1 and x2 on y
```{r}
lm(y ~ x1, data = d_mixed) |> 
  tidy()

lm(y ~ x2, data = d_mixed) |> 
  tidy()
```

Partial (direct, unique) effects of x1 and x2 on y
```{r}
lm(y ~ x1 + x2, data = d_mixed) |> 
  tidy()
```




-------------------------------------------------------------------------------

## Path diagram




-------------------------------------------------------------------------------

## Suppression

When partial (direct, unique) predictor effects are 

- larger in magnitude or 
- opposite in sign 

relative to their overall effects


This occurs when the direct and indirect effects of a predictor on the outcome work in opposite directions.


