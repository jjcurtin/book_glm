{
  "hash": "5f5adc23745936a58098445e59dbb43a",
  "result": {
    "engine": "knitr",
    "markdown": "--- \noutput: html_document \neditor_options:  \n  chunk_output_type: console\n--- \n\n\n\n \n\n# Inferences about a Single Dichotomous Predictor\n\n\n\n\n::: {.cell}\n\n:::\n\n\n\n\n\n## Categorical Variables in GLM\n\n1. One dichotomous predictor coded with one regressor (*this unit*).   \n\n2. Learn models with multiple regressors in later units:\n\n  - One-way between subject ANOVA (One predictor, multiple regressors) \n  - Multiple predictors and regressors\n\t  - *Additive:*  ANCOVA, General Additive Models\n\t  - *Interactive:* Factorial ANOVA, Attitude Treatment Interactions, General Interactive Models    \n\n3. Repeated measures & mixed model designs\n  \n-----\n\n## Dichotomous Predictor\n  \n<span style=\"color: red;\">Question: Consider a regression model with one dichotomous predictor and the typical continuous DV. What other statistical test is this regression equivalent to?</span>\n\n-----\n\n<span style=\"color: blue;\">An independent samples (between subjects) t-test comparing the two groups that are represented by the two levels of the predictor on the mean of the DV.</span>\n\n\n-----\n\n## Coding Dichotomous Predictors\n\n<span style=\"color: red;\">Question: How do we handle analysis of dichotomous predictors in regression?</span>\n\n-----\n\n<span style=\"color: blue;\">Very simple! We will assign two “arbitrary” values to a regressor $X$ to represent the two levels (groups) in the dichotomous predictor variable.</span>\n\nThere are 2 coding schemes that we will need to learn:    \n\n1. Dummy coding (reference/control group)\n2. Contrast coding (for now, unit weighted, centered coefficients).   \n\nWe also need to learn distinction between weighted vs. unweighted means (optional).   \n\n\n-----\n\n## Dummy Coding\n\n**Dummy coding with a dichotomous variable:**.  \nDummy coding involves assigning 1’s and 0’s to the regressor in a specific pattern.  For the two level simple case, assign a 0 to the control/reference group and a 1 to the target or experimental group.  (Doesn’t *really* matter which is which; <span style=\"color: red;\">but what would change?  What about -1 vs. 1</span>)\n\n-----\n\n## Our Running Example\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(patchwork)\n\ntheme_set(theme_classic()) \n\npath_data <- \"data_lecture\" \n\ndata <- read_csv(here::here(path_data, \"5_single_dichotomous_bg_fps.csv\"),\n                 show_col_types = FALSE) |> \n  glimpse()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 96\nColumns: 4\n$ subid <chr> \"0011\", \"0012\", \"0013\", \"0014\", \"0015\", \"0016\", \"0021\", \"0022\", …\n$ bg_2  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ sex   <chr> \"female\", \"female\", \"female\", \"female\", \"female\", \"female\", \"fem…\n$ fps   <dbl> 19.4909278, 48.4069444, -22.5285000, 6.7237833, 89.6587222, 40.5…\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |> \n  pivot_longer(where(is.numeric), names_to = \"var\") |> \n  group_by(var) |> \n  summarise(n = n(),\n            mean = mean(value),\n            sd = sd(value),\n            min = min(value),\n            max = max(value))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 6\n  var       n  mean     sd   min   max\n  <chr> <int> <dbl>  <dbl> <dbl> <dbl>\n1 bg_2     96  0.75  0.435   0      1 \n2 fps      96 32.2  37.5   -98.1  163.\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |> \n  group_by(bg_2) |> \n  count()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 2\n# Groups:   bg_2 [2]\n   bg_2     n\n  <dbl> <int>\n1     0    24\n2     1    72\n```\n\n\n:::\n:::\n\n\n\n\n\n-----\n\n## Dichotomous Beverage Group\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_d <- lm(fps ~ bg_2, data = data)\n\nm_d |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic    p.value\n  <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n1 (Intercept)    37.1       7.68     4.83  0.00000524\n2 bg_2           -6.57      8.87    -0.741 0.461     \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_q <- lm(fps ~ bac, data = data_q)\n\nm_q |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic       p.value\n  <chr>          <dbl>     <dbl>     <dbl>         <dbl>\n1 (Intercept)     42.5      6.55      6.48 0.00000000411\n2 bac           -184.      95.9      -1.92 0.0579       \n```\n\n\n:::\n:::\n\n\n\n\n\n<span style=\"color: red;\">Question: What is different about the NHST of the *alcohol* effect with bg_2 vs BAC and why?</span>   \n\n-----\n\n## >SSE leads to >SEs and <Power\n\n<span style=\"color: blue;\">p-value is worse (bigger) for bg_2 than BAC. Taking a quantitative variable and dichotomizing (or trichotomizing, etc.) throws away potentially valuable information in  your predictor variable. The dichotomous variable will generally be a worse predictor. This will produce a model with more error (> SSE) and less power (> p-values) to test hypotheses.</span>   \n\n\n<span style=\"color: blue;\">Don’t dichotomize unless there is a **REALLY** good reason. GLM can accommodate quantitative variables anywhere you would have previously used a categorical variable.</span>  \n\n\n$\\text{SE}_{b_0}=\\sqrt{\\frac{\\text{SSE}}{N-P}}*\\sqrt{\\frac{1}{N}+\\frac{(\\overline{X})^2}{(N-1)*S_x^2}}$  \n\n$\\text{SE}_{b_1}=\\frac{s_y}{s_x}*\\sqrt{\\frac{1-R^2}{N-P}}$\n\n\n-----\n\n## Dichotomous Beverage Group (cont.)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nm_d |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic    p.value\n  <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n1 (Intercept)    37.1       7.68     4.83  0.00000524\n2 bg_2           -6.57      8.87    -0.741 0.461     \n```\n\n\n:::\n:::\n\n\n\n\n<span style=\"color: red;\">Question: What is the interpretation of $b_1$ (bg_2) in this model?</span>\n\n-----\n\n<span style=\"color: blue;\">Still change in $Y$ for one unit change in $X$.</span>   \n\n<span style=\"color: blue;\">However, a one unit change in $X$ moves from the no-alcohol group (coded 0) to alcohol group (coded 1).  Therefore $b_1$ is now the predicted change in $Y$ between no-alcohol and alcohol groups. This is simply the difference in the mean of the two groups!</span>\n\n-----\n\n<span style=\"color: red;\">Question: Where is $b_1$ (bg_2 effect) on this graph?</span>   \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_d <- data |> \n  ggplot(aes(x = bg_2, y = fps)) +\n  geom_point(alpha = .6, size = 2) +\n  geom_abline(aes(intercept = coef(m_d)[1],\n                  slope = coef(m_d)[2]),\n                  linewidth = 1) \n\nplot_d\n```\n\n::: {.cell-output-display}\n![](05_single_dichotomous_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n-----\n\n<span style=\"color: blue;\">It is the slope of the line (as before). The line goes through the mean of FPS scores for each of the two groups.</span>   \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlabels <- tibble(means = c(round(mean(subset(data, bg_2 == 0)$fps), 2), \n                           round(mean(subset(data, bg_2 == 1)$fps), 2)),\n                 vars = c(\"bg_1\", \"bg_2\"))\nplot_d +\n  annotate(\"text\", x = -.15, y = labels$means[1], label = labels$means[1], \n           size = 6, color = \"blue\") +\n  annotate(\"text\", x = 1.1, y = labels$means[2], label = labels$means[2], \n           size = 6, color = \"blue\") +\n  annotate(\"text\", x = 0, y = -140, label = \"No Alcohol\", \n           size = 5, color = \"blue\") +\n   annotate(\"text\", x = 1, y = -140, label = \"Alcohol\", \n           size = 5, color = \"blue\") +\n  coord_cartesian(xlim = c(0, 1),\n                  (ylim = c(-100, 175)),\n                  clip = \"off\") +\n  theme(plot.margin = unit(c(0, .75, .5, .75), \"inches\"))\n```\n\n::: {.cell-output-display}\n![](05_single_dichotomous_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nm_d |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic    p.value\n  <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n1 (Intercept)    37.1       7.68     4.83  0.00000524\n2 bg_2           -6.57      8.87    -0.741 0.461     \n```\n\n\n:::\n:::\n\n\n\n\n<span style=\"color: red;\">Question: What is the interpretation of $b_0$ in this model?</span>\n\n-----\n\n<span style=\"color: blue;\">Still predicted value for $Y$ when $X$ = 0.</span>   \n\n<span style=\"color: blue;\">In this context, that is the predicted FPS score for the no-alcohol group (coded 0).</span>\n\n-----\n\n<span style=\"color: red;\">Question: Where is $b_0$ on this graph?</span>   \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_d\n```\n\n::: {.cell-output-display}\n![](05_single_dichotomous_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n\n-----\n\n<span style=\"color: blue;\">It is the $Y$ intercept as before. The value of FPS when $X$ = 0.</span>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_d +\n  annotate(\"text\", x = -.15, y = labels$means[1], label = labels$means[1], \n           size = 6, color = \"blue\") +\n  annotate(\"text\", x = 0, y = -140, label = \"No Alcohol\", \n           size = 5, color = \"blue\") +\n  coord_cartesian(xlim = c(0, 1),\n                  (ylim = c(-100, 175)),\n                  clip = \"off\") +\n  theme(plot.margin = unit(c(0, 0, .5, .75), \"inches\"))\n```\n\n::: {.cell-output-display}\n![](05_single_dichotomous_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n\n-----\n\n<span style=\"color: red;\">Question: Does alcohol affect FPS?</span>\n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nm_d |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic    p.value\n  <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n1 (Intercept)    37.1       7.68     4.83  0.00000524\n2 bg_2           -6.57      8.87    -0.741 0.461     \n```\n\n\n:::\n:::\n\n\n\n\n\n$H_0: \\beta_1 = 0$   \n$H_a: \\beta_1 \\neq 0$   \n\n<span style=\"color: blue;\">No. The probability of getting a $b_1$ of -6.568 or more extreme is 0.461 if the null hypothesis is true.  This is not sufficient evidence to reject the null.</span>\n\n-----\n\n## Model Comparisons ($\\beta_1$)\n\n<span style=\"color: red;\">Question: What two models are you comparing to test your hypotheses about alcohol’s effect on FPS?</span>   \n\n-----\n\n$H_0: \\beta_1 = 0$  \n$H_a: \\beta_1 \\neq 0$   \n\n<span style=\"color: blue;\">Compact model:  $\\hat{\\text{FPS}}_i = \\beta_0+0*\\text{bg}\\_2_i$</span>  \n$P_c = 1$  \n$\\text{SSE}_c = 133888.28$  \n\n\n<span style=\"color: blue;\">Augmented model:  $\\hat{\\text{FPS}}_i=\\beta_0+\\beta_1*\\text{bg}\\_2_i$</span>   \n$P_a=2$  \n$\\text{SSE}_a = 133111.76$\n\n-----\n\n<span style=\"color: red;\">Question: How do you use this information to calculate $\\eta_p^2$ (PRE) for the bg_2 effect?</span> \n\n-----\n\nCompact model:  $\\hat{\\text{FPS}}_i=\\beta_0+0*\\text{bg}\\_2_i$  \n$P_c = 1$  \n$\\text{SSE}_c = 133888.28$   \n\n\nAugmented model:  $\\hat{\\text{FPS}}_i=\\beta_0+\\beta_1*\\text{bg}\\_2_i$   \n$P_a=2$  \n$\\text{SSE}_a = 133111.76$\n\n<span style=\"color: blue;\">PRE or $\\eta_p^2$ is the proportion reduction in error due to the effect (the parameter). Use the same models that you would use to test the hypotheses about that parameter.</span>  \n\n<span style=\"color: blue;\">$\\frac{\\text{SSE}_c - \\text{SSE}_a}{\\text{SSE}_c}=\\frac{133888.28 - 133111.76}{133888.28} = 0.0058$</span>\n\n-----\n\n## Testing $\\beta_0$\n\n<span style=\"color: red;\">Question: Does our task produce non-zero fear potentiated startle in sober people?</span> \n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nm_d |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic    p.value\n  <chr>          <dbl>     <dbl>     <dbl>      <dbl>\n1 (Intercept)    37.1       7.68     4.83  0.00000524\n2 bg_2           -6.57      8.87    -0.741 0.461     \n```\n\n\n:::\n:::\n\n\n\n\n$H_0: \\beta_0 = 0$  \n$H_a: \\beta_0 \\neq 0$   \n\n<span style=\"color: blue;\">Yes. The probability of getting a $b_0$ of 37.117 or more extreme is 0.0000052 if the null hypothesis is true.  Very unlikely so reject null. Conclude $B_0 > 0$.</span>\n\n-----\n\n## Model Comparisons ($\\beta_0$)\n\n<span style=\"color: red;\">Question: What two models are you comparing to test your hypotheses about mean FPS for sober people?</span>  \n\n-----\n\n$H_0: \\beta_0 = 0$  \n$H_a: \\beta_0 \\neq 0$   \n\n<span style=\"color: blue;\">Compact model: $\\hat{\\text{FPS}}_i=0+\\beta_1*\\text{bg}\\_2_i$</span>  \n\n$P_c = 1$  \n$\\text{SSE}_c = 166175.76$  \n\n\n<span style=\"color: blue;\">Augmented model: $\\hat{\\text{FPS}}_i=\\beta_0+\\beta_1*\\text{bg}\\_2_i$</span>   \n\n$P_a=2$  \n$\\text{SSE}_a = 133111.76$\n\n-----\n\n<span style=\"color: red;\">Question: How do you use this information to calculate $\\eta_p^2$ (PRE) for $\\beta_0$?</span>  \n\n-----\n\nCompact model: $\\hat{\\text{FPS}}_i=0+\\beta_1*\\text{bg}\\_2_i$  \n\n$P_c = 1$  \n$\\text{SSE}_c = 166175.76$  \n\n\nAugmented model: $\\hat{\\text{FPS}}_i=\\beta_0+\\beta_1*\\text{bg}\\_2_i$   \n\n$P_a=2$  \n$\\text{SSE}_a = 133111.76$  \n\n<span style=\"color: blue;\">PRE or $\\eta_p^2$ is the proportion reduction in error due to the effect (the parameter). Use the same models that you would use to test the hypotheses about that parameter.</span>  \n\n<span style=\"color: blue;\">$\\frac{\\text{SSE}_c - \\text{SSE}_a}{\\text{SSE}_c}= \\frac{166175.76 - 133111.76}{166175.76 } = 0.199$</span>\n\n-----\n\n<span style=\"color: red;\">Question: How do you use this information to calculate $R^2$ for the augmented model?</span>  \n\n-----\n\nMean Only model: $\\hat{\\text{FPS}_i}=\\beta_0$  \n\n$P_c = 1$  \n$\\text{SSE}_c = 133888.28$  \n\n\nAugmented model: $\\hat{\\text{FPS}}=\\beta_0+\\beta_1*\\text{bg}\\_2_i$   \n\n$P_a=2$  \n$\\text{SSE}_a = 133111.76$  \n\n<span style=\"color: blue;\">$R^2$ is the proportion of explained variance over total variance in $Y$. The total variance is equivalent to the SSE of the Mean Only model (</span><span style=\"color: red;\">WHY?</span><span style=\"color: blue;\">).</span>   \n\n$\\frac{\\text{SSE}_\\text{mean}-\\text{SSE}_a}{\\text{SSE}_\\text{mean}}=\\frac{133888.28 - 133111.76}{133888.28}$ = 0.0058$ \n\n<span style=\"color: blue;\">At this point it equals PRE b/c $\\text{SSE}_c$ is the mean only model!</span>  \n\n-----\n\n## Effect Sizes in R\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_mean <- lm(fps ~ 1, data = data) \nm_d <- lm(fps ~ bg_2, data = data)\n```\n:::\n\n\n\n\n$\\eta_p^2$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(sum(residuals(m_mean)^2)- sum(residuals(m_d)^2))/sum(residuals(m_mean)^2) \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.005799798\n```\n\n\n:::\n:::\n\n\n\n\n$R^2$\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::glance(m_d)$r.squared \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.005799798\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n## Unit Weighted, Centered Coefficients\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data |> \n  mutate(bg_2c = if_else(bg_2 == 0, -.5, .5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_c <- lm(fps ~ bg_2c, data = data)\n\nm_c |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    33.8       4.43     7.63  1.90e-11\n2 bg_2c          -6.57      8.87    -0.741 4.61e- 1\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n## Visual Displays of Dummy vs. Centered\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_d <- plot_d +\n  labs(title = \"Dummy\")\n\nplot_c <- data |> \n  ggplot(aes(x = bg_2c, y = fps)) +\n  geom_point(alpha = .6, size = 2) +\n  geom_abline(aes(intercept = coef(m_c)[1],\n                  slope = coef(m_c)[2]),\n                  linewidth = 1) +\n  labs(title = \"Zero-centered\")\n  \n  \nplot_d + plot_c\n```\n\n::: {.cell-output-display}\n![](05_single_dichotomous_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\n\n\n\n<span style=\"color: red;\">Question: $b_0, b_1$ in each?</span>  \n\n-----\n\n## $b_0$ with Zero-Centered Coefficients\n\n<span style=\"color: red;\">Question: Is $b_0$ (33.83) the mean of FPS in the sample?</span>    \n\n-----\n\n<span style=\"color: blue;\">It is the unweighted mean.</span>    \n\n<span style=\"color: blue;\">Weighted and unweighted means emerge as concepts with grouped data.   An unweighted mean is the mean of the group means, ignoring the $N$ in each group.</span>    \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |> \n  summarise(mean = mean(fps),\n            sd = sd(fps))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 2\n   mean    sd\n  <dbl> <dbl>\n1  32.2  37.5\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |> \n  group_by(bg_2) |> \n  summarise(mean = mean(fps),\n            sd = sd(fps))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 3\n   bg_2  mean    sd\n  <dbl> <dbl> <dbl>\n1     0  37.1  46.1\n2     1  30.5  34.4\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n## $b_0$ as Weighted Mean\n\nA weighted mean is the mean of the groups *weighted* or proportional to their sample sizes. It is also equal to the grand mean of the DV ignoring group.  \n\n<span style=\"color: red;\">Question: How can you get $b_0$ to reflect the weighted mean?</span>.  \n\n-----\n\n<span style=\"color: blue;\">Mean center $X$. This is the same as we did with a quantitative variable to make $b_0$ equal the grand mean.</span>   \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data |> \n  mutate(bg_2mc = bg_2 - mean(bg_2))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |> \n  pull(bg_2mc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75\n[13] -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75 -0.75\n[25]  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25\n[37]  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25\n[49]  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25\n[61]  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25\n[73]  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25\n[85]  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25  0.25\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean(data$bg_2mc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n:::\n\n\n\n\n\n-----\n\n## $b_0$ as Weighted Mean\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm_mc <- lm(fps ~ bg_2mc, data = data)\n\nm_mc |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    32.2       3.84     8.38  5.02e-13\n2 bg_2mc         -6.57      8.87    -0.741 4.61e- 1\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n## Comparing $b_0$ Across Models\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nplot_d <- plot_d +\n  labs(title = \"Dummy\") +\n  annotate(\"text\", x = -.1, y = round(coef(m_d)[1],2) + 10, label = round(coef(m_d)[1],2), \n           size = 5, color = \"blue\") +\n  coord_cartesian(clip = \"off\") \n\nplot_c <- data |> \n  ggplot(aes(x = bg_2c, y = fps)) +\n  geom_point(alpha = .6, size = 2) +\n  geom_abline(aes(intercept = coef(m_c)[1],\n                  slope = coef(m_c)[2]),\n                  linewidth = 1) +\n  labs(title = \"Zero-centered\")  +\n  annotate(\"text\", x = 0, y = round(coef(m_c)[1],2) + 10, label = round(coef(m_c)[1],2), \n           size = 5, color = \"blue\") +\n  coord_cartesian(clip = \"off\") \n\nplot_mc <- data |> \n  ggplot(aes(x = bg_2mc, y = fps)) +\n  geom_point(alpha = .6, size = 2) +\n  geom_abline(aes(intercept = coef(m_mc)[1],\n                  slope = coef(m_mc)[2]),\n                  linewidth = 1) +\n  labs(title = \"Mean-centered\") +\n  annotate(\"text\", x = .9, y = round(coef(m_mc)[1],2) + 10, label = round(coef(m_mc)[1],2), \n           size = 5, color = \"blue\") +\n  coord_cartesian(clip = \"off\") \n\n  \n  \nplot_d + plot_c + plot_mc\n```\n\n::: {.cell-output-display}\n![](05_single_dichotomous_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\n\n\n\n\n-----\n\n## Other (not useful) Coefficients\n\n<span style=\"color: red;\">What would be the interpretation of $b_0$ and $b_1$ if I used coefficients of -1 and 1 for bg_2?</span>\n\n-----\n\n<span style=\"color: blue;\">$b_0$ will be the unweighted mean of FPS because 0 is halfway between the two groups.</span>    \n\n\n<span style=\"color: blue;\">$b_1$ will be half what it was in all previous models b/c a one unit change on $X$ will only go halfway between no-alcohol and alcohol groups.</span>\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data |> \n  mutate(bg_2o = if_else(bg_2==0, -1, 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm_o <- lm(fps ~ bg_2o, data = data)\n\nm_o |> \n  broom::tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    33.8       4.43     7.63  1.90e-11\n2 bg_2o          -3.28      4.43    -0.741 4.61e- 1\n```\n\n\n:::\n:::\n\n\n\n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata |> \n  ggplot(aes(x = bg_2o, y = fps)) +\n  geom_point(alpha = .6, size = 2) +\n  geom_abline(aes(intercept = coef(m_o)[1],\n                  slope = coef(m_o)[2]),\n                  linewidth = 1) \n```\n\n::: {.cell-output-display}\n![](05_single_dichotomous_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n:::\n\n\n\n\n-----\n\n## Publication Quality Figure\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- tibble(bg_2 = c(0,1))\n\npreds_pub <- x |> \n  bind_cols(predict(m_d, x, se.fit = TRUE) |> \n  as_tibble())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_pub <- ggplot() +\n  geom_col(aes(x = as.factor(preds_pub$bg_2), y = preds_pub$fit, \n               fill = as.factor(preds_pub$bg_2)),\n           alpha = .4, color = \"black\") +\n  geom_jitter(aes(x = as.factor(data$bg_2), y = data$fps), width = .02, height = NULL) +\n  geom_errorbar(aes(ymin = preds_pub$fit-preds_pub$se.fit, \n                    ymax = preds_pub$fit+preds_pub$se.fit, \n                    x = as.factor(preds_pub$bg_2)), width = .4) +\n  scale_fill_manual(values = c(\"black\", \"light grey\")) +\n  scale_x_discrete(breaks = c(0, 1),\n                   labels = c(\"No alcohol\", \"Alcohol\")) +\n  theme(legend.position = \"none\") +\n  labs(x = \"Group\",\n       y = \"Fear-potentiated startle\") \n```\n:::\n\n\n\n\n-----\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_pub\n```\n\n::: {.cell-output-display}\n![Bars display point estimates for fear potentiated startle by group from the general linear model. Confidence intervals display +/- 1 standard error for these point estimates.](05_single_dichotomous_files/figure-html/unnamed-chunk-34-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "05_single_dichotomous_files\\figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}